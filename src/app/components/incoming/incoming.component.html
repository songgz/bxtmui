<div class="mat-card pb20 pl20 pr20 pt20 mb-20">
  <!--  查询-->
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <mat-select placeholder="所属学院"  [(value)]="student.college_id" name="college_id">
      <mat-option *ngFor="let college of colleges | async" [value]="college.id">
        {{college.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <mat-select placeholder="所属系部"  [(value)]="student.department_id"  name="department_id">
      <mat-option *ngFor="let department of departments | async" [value]="department.id">
        {{department.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <mat-select placeholder="所属年级"  [(ngModel)]="student.grade_mark"  name="grade_mark">
      <mat-option *ngFor="let grade of student.department?.grades" [value]="grade.mark">
        {{grade.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <mat-select placeholder="所属班级"  [(ngModel)]="student.classroom_id"  name="classroom_id">
      <mat-option *ngFor="let classroom of classrooms | async" [value]="classroom.id">
        {{classroom.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <br [ngClass]="{ 'moreserch' : moreserch === false}">
  <mat-form-field>
    <mat-select placeholder="所属楼栋"  [(value)]="student.house_id" (selectionChange)="filterRooms()"  name="house_id">
      <mat-option *ngFor="let house of houses | async" [value]="house.id">
        {{house.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <mat-select placeholder="所属楼层"  [(value)]="student.floor_id"  name="floor_id">
      <mat-option *ngFor="let floor of floors | async" [value]="floor.id">
        {{floor.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <mat-select placeholder="所属房间"  [(ngModel)]="student.room_id"  name="room_id">
      <mat-option *ngFor="let room of rooms | async" [value]="room.id">
        {{room.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <mat-form-field>
    <input matInput placeholder="超时（时）" [(ngModel)]="student.overtime_at_last" name="overtime_at_last" >
  </mat-form-field>
  <mat-form-field>
    <input matInput placeholder="驻留（天）" [(ngModel)]="student.reside" name="reside" >
  </mat-form-field>
  <br [ngClass]="{ 'moreserch' : moreserch === false}">
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <input matInput placeholder="学号" [(ngModel)]="student.id_card" name="id_card" >
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <input matInput placeholder="姓名" [(ngModel)]="student.name" name="name" >
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <input matInput placeholder="电话" [(ngModel)]="student.tel" name="tel" >
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <mat-select placeholder="性别" [(ngModel)]="student.gender_mark" name="gender_mark">
      <mat-option *ngFor="let gender of genders | async" [value]="gender.mark" >
        {{gender.title}}
      </mat-option>
    </mat-select>
  </mat-form-field>
  <br [ngClass]="{ 'moreserch' : moreserch === false}">
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <input matInput placeholder="起始日期" (change)="shuchu(this.student.starttime)" type="date" [(ngModel)]="student.starttime" name="starttime" >
  </mat-form-field>
  <mat-form-field [ngClass]="{ 'moreserch' : moreserch === false}">
    <input matInput placeholder="结束日期" (change)="shuchu(this.student.endtime)" type="date" [(ngModel)]="student.endtime" name="endtime" >
  </mat-form-field>
</div>
<div class="searchbox">
  <span class="bxt-toolbar-spacer"></span>
  <button mat-flat-button color="warn" (click)="serchbtn()"> <mat-icon>search</mat-icon>查询</button>
  <button mat-flat-button color="primary" (click)="moreserchbtn()"> <mat-icon>more_vert</mat-icon>{{moreserch?'隐藏更多':'显示更多'}}</button>
</div>

<div fxLayout fxLayout.lt-md="column wrap" fxLayoutAlign="center center" fxLayoutGap.gt-sm="250px" fxLayoutGap.lt.md="20px">
  <mat-form-field class="search">
    <input matInput (keyup)="applyFilter($event.target.value)" placeholder="快速查找（姓名或学号）">
  </mat-form-field>
</div>
<mat-toolbar class="mat-elevation-z8">
  <span>归寝管理</span>
  <span class="bxt-toolbar-spacer"></span>
</mat-toolbar>
<div class="mat-elevation-z8">
  <table mat-table [dataSource]="dataSource" matSort>
    <ng-container matColumnDef="name">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 学生 </th>
      <td mat-cell *matCellDef="let row"> {{row.name}} </td>
    </ng-container>
    <ng-container matColumnDef="sno">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 学号 </th>
      <td mat-cell *matCellDef="let row"> {{row.sno}} </td>
    </ng-container>
    <ng-container matColumnDef="dept_title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 班级 </th>
      <td mat-cell *matCellDef="let row"> {{row.dept_title}} </td>
    </ng-container>
    <ng-container matColumnDef="dorm_title">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 寝室 </th>
      <td mat-cell *matCellDef="let row"> {{row.dorm_title}} </td>
    </ng-container>
    <ng-container matColumnDef="pass_time">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 时间 </th>
      <td mat-cell *matCellDef="let row"> {{row.pass_time_at_last | date:'yyyy-MM-dd HH:mm'}} </td>
    </ng-container>
    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 状态 </th>
      <td mat-cell *matCellDef="let row"> {{row.status_at_last}} </td>
    </ng-container>
    <ng-container matColumnDef="overtime">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 超时(时) </th>
      <td mat-cell *matCellDef="let row"> {{row.overtime_at_last}} </td>
    </ng-container>
    <ng-container matColumnDef="reside">
      <th mat-header-cell *matHeaderCellDef mat-sort-header> 驻留(天)</th>
      <td mat-cell *matCellDef="let row"> {{row.reside}} </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
  <mat-paginator [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
</div>
